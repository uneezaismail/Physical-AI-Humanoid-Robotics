# Implementation Plan: Interactive Urdu Translation Button

**Branch**: `002-urdu-translation` | **Date**: 2025-12-18 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/002-urdu-translation/spec.md`

**Note**: This plan was generated by the `/sp.plan` command following the Spec-Driven Development workflow.

## Summary

Enable users to toggle between English and Urdu content via an interactive button positioned below chapter titles. The feature leverages Docusaurus's built-in i18n system with pre-translated Urdu markdown files, implements client-side language switching without page reloads, persists language preference in browser localStorage, and ensures proper RTL (right-to-left) layout for Urdu content. URL parameters (`?lang=ur`) override stored preferences to enable consistent sharing of language-specific content.

## Technical Context

**Language/Version**: TypeScript 5.x (React 18+ via Docusaurus 3.x)
**Primary Dependencies**:
- Docusaurus 3.x (static site generator with React)
- React 18+ (UI components)
- @docusaurus/theme-classic (theme with i18n support)
- NEEDS CLARIFICATION: State management approach (React Context vs custom hooks vs library)

**Storage**: Browser localStorage for language preference persistence (client-side only, no backend)
**Testing**: Jest + React Testing Library for component tests, Playwright for E2E translation flow
**Target Platform**: Modern web browsers (Chrome, Firefox, Safari, Edge) - desktop and mobile
**Project Type**: Web application (Docusaurus-based static site with React components)
**Performance Goals**:
- Language switch < 2 seconds (SC-001)
- Page load with preferred language < 100ms detection time (SC-008)
- No visible content shifting or flashing during language application

**Constraints**:
- Client-side only (static site deployment via GitHub Pages/Vercel)
- No page reloads during language switching (FR-014)
- RTL layout must not break existing components
- Code blocks must remain untranslated with 100% accuracy (SC-004)

**Scale/Scope**:
- 2 languages (English, Urdu)
- ~50-100 chapter pages
- Single translation button component per chapter
- URL parameter support for language override

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### Principle I: Educational Excellence First
**Status**: ✅ PASS
- **Rationale**: Feature enhances educational accessibility by enabling Urdu-speaking learners to access content in their native language. Does not modify educational content structure or quality.
- **Verification**: Translation button is purely an accessibility/UX feature. Educational content (chapters, code examples, exercises) remains unchanged and maintains quality standards.

### Principle II: Technical Accuracy & Verifiability
**Status**: ✅ PASS
- **Rationale**: Uses pre-translated Urdu content files (FR-010), ensuring accuracy through manual translation review rather than real-time machine translation.
- **Verification**: Code blocks remain in English (FR-005, SC-004), preventing translation errors in technical content. All Docusaurus i18n APIs and React patterns follow official documentation.

### Principle III: Spec-Driven Development
**Status**: ✅ PASS
- **Rationale**: Following standard workflow: spec.md → clarifications → plan.md (current phase) → tasks.md → implementation
- **Verification**: Specification complete with 3 clarifications resolved. No code written yet. Plan being created before implementation.

### Principle IV: Type Safety & Async-First Design
**Status**: ✅ PASS
- **Rationale**: TypeScript strict mode already enabled in Docusaurus config. React component will use TypeScript with proper typing.
- **Verification**: Language preference storage/retrieval will use typed interfaces. No async operations required (client-side localStorage is synchronous).
- **Note**: Client-side feature - no backend async/await needed.

### Principle V: Security & Privacy by Design
**Status**: ✅ PASS
- **Rationale**: No sensitive data collected. Language preference stored in client-side localStorage (non-sensitive user preference).
- **Verification**: No API keys, no server communication, no user authentication required. URL parameters are read-only (query string parsing).

### Principle VI: Testing & Validation
**Status**: ✅ PASS (with test plan)
- **Platform Testing**:
  - Unit tests: LanguageSwitcher component state management
  - Integration tests: localStorage persistence, URL parameter parsing
  - E2E tests: Full language switch flow, RTL layout verification
- **Content Validation**:
  - Verify code blocks remain untranslated (automated check)
  - Test RTL layout on sample chapters without breaks
- **User Experience Validation**:
  - Mobile responsive: Button touch target ≥ 44x44px
  - Language switch < 2 seconds (SC-001)
  - Cross-browser compatibility (Chrome, Firefox, Safari, Edge)

### Principle VII: Progressive Enhancement & Graceful Degradation
**Status**: ✅ PASS
- **Rationale**: Feature degrades gracefully if JavaScript disabled (falls back to default English per edge case)
- **Verification**: Static content remains accessible. Translation button shown only when JavaScript enabled. No runtime errors if localStorage unavailable.

### Principle VIII: Performance & Scalability
**Status**: ✅ PASS
- **Rationale**: Client-side language switching with pre-built static files. No runtime translation overhead.
- **Verification**:
  - < 2 second language switch (SC-001) - client-side DOM update only
  - < 100ms preference detection (SC-008) - single localStorage read
  - No impact on Docusaurus build time (pre-translated files built statically)

### Principle IX: Observability & Debugging
**Status**: ✅ PASS (RESOLVED via Research Phase)
- **Decision**: Console logging in development mode; optional analytics integration in production
- **Implementation**: Structured JSON logging in dev, custom GA events in prod (optional)
- **Resolution**: See research.md Section 6 for detailed logging strategy
- **Verification**: Development logs help debug localStorage issues, URL parsing, and routing. No PII collected.

### Principle X: Simplicity & Pragmatism (YAGNI)
**Status**: ✅ PASS
- **Rationale**: Minimal complexity - single React component, localStorage for persistence, URL parameter parsing. No over-engineering.
- **Verification**: No unnecessary abstractions. Uses Docusaurus built-in i18n instead of custom translation system. Direct DOM manipulation for RTL switching (standard web pattern).

## Project Structure

### Documentation (this feature)

```text
specs/002-urdu-translation/
├── spec.md              # Feature specification (completed)
├── plan.md              # This file (implementation plan)
├── research.md          # Phase 0: Research findings
├── data-model.md        # Phase 1: Data model (language preference state)
├── quickstart.md        # Phase 1: Developer quickstart guide
├── contracts/           # Phase 1: Component API contracts
│   └── LanguageSwitcher.contract.ts  # TypeScript interface definitions
└── tasks.md             # Phase 2: Generated by /sp.tasks (NOT created by /sp.plan)
```

### Source Code (repository root)

```text
frontend/
├── src/
│   ├── components/
│   │   ├── LanguageSwitcher/        # NEW: Translation button component
│   │   │   ├── LanguageSwitcher.tsx
│   │   │   ├── LanguageSwitcher.module.css
│   │   │   └── index.ts
│   │   └── ...
│   ├── hooks/
│   │   └── useLanguagePreference.ts  # NEW: Language preference hook
│   ├── utils/
│   │   └── i18n.ts                   # NEW: i18n utility functions
│   ├── theme/
│   │   └── DocItem/                  # Swizzled Docusaurus component
│   │       └── index.tsx             # Modified to include LanguageSwitcher
│   └── css/
│       └── rtl.css                   # NEW: RTL-specific styles
├── i18n/
│   └── ur/                           # Urdu translations (pre-existing from urdu-translator skill)
│       ├── code.json
│       ├── docusaurus-theme-classic/
│       └── docusaurus-plugin-content-docs/
│           └── current/              # Translated chapter markdown files
├── docs/                             # Chapter markdown files (English)
├── docusaurus.config.ts             # MODIFIED: Add Urdu locale configuration
└── tests/
    ├── components/
    │   └── LanguageSwitcher.test.tsx # Component unit tests
    └── e2e/
        └── language-switching.spec.ts # Playwright E2E tests
```

**Structure Decision**: Web application structure (frontend-only). This is a pure frontend feature built as a React component within the existing Docusaurus static site. No backend modifications required. Component follows Docusaurus theming patterns with swizzled `DocItem` component to inject the translation button below chapter titles.

## Complexity Tracking

> **Fill ONLY if Constitution Check has violations that must be justified**

**No violations detected.** Constitution Check passed 9/10 principles with 1 needs clarification (Principle IX: Observability - logging strategy). All complexity is justified by functional requirements. No YAGNI violations identified.
